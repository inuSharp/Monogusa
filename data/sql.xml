<?xml version="1.0" encoding="utf-8"?>
<SQL>
<!-- 取得 -->
<GetWorkById>
select * from works where id = :id;
</GetWorkById>
<GetTagIdByName>
select id from tags where name = ':name';
</GetTagIdByName>
<GetTagsByWorkId>
select * from tags where id in (select tag_id from work_tags where work_id = :work_id);
</GetTagsByWorkId>
<GetTagNames>
select name from tags where type = :type order by name;
</GetTagNames>
<GetWorkTagByWorkIdAndTagId>
select * from work_tags where work_id = :work_id and tag_id = :tag_id;
</GetWorkTagByWorkIdAndTagId>
<GetTagNamesByWorkId>
select name from tags where id in (select tag_id from work_tags where work_id = :work_id);
</GetTagNamesByWorkId>
<GetUserByEmail>
select * from users where email = ':email';
</GetUserByEmail>
<GetActivate>
select * from  activations where user_id = :user_id and activate_key = ':key';
</GetActivate>

<!-- 登録 -->
<AddWork>
insert into works (title,updated_at) values (':work_title', now());
</AddWork>
<AddTag>
insert into tags (name, type) values (':tag_name', :tag_type);
</AddTag>
<AddTagOfWork>
insert into work_tags (work_id,tag_id) values (:work_id, :tag_id);
</AddTagOfWork>
<AddUser>
insert into users (name, email, password, activated, created_at, updated_at) values (':name', ':email', ':password', 0, now(), now());
</AddUser>
<AddActivation>
insert into activations (user_id, activate_key, limit_date) values (:user_id, ':key', ':limit');
</AddActivation>

<!-- 更新 -->
<updateWorkPoint>
update works set point = :point where id = :work_id;
</updateWorkPoint>
<updateWorkOfficialWebSite>
update works set official_web_site = ':official_web_site' where id = :work_id;
</updateWorkOfficialWebSite>
<updateWorkQuotation>
update works set quotation = ':quotation' where id = :work_id;
</updateWorkQuotation>
<updateWorkQuoteSource>
update works set quote_source = ':quote_source' where id = :work_id;
</updateWorkQuoteSource>
<updateWorkExplanation>
update works set explanation = ':explanation' where id = :work_id;
</updateWorkExplanation>
<updateUserActive>
update users set activated = 1 where id = :user_id;
</updateUserActive>

<!-- 削除 -->
<deleteTagsByWorkIdAndTagId>
delete from work_tags where work_id = :work_id and tag_id = :tag_id;
</deleteTagsByWorkIdAndTagId>
<deleteActivation>
delete from activations where user_id = :user_id;
</deleteActivation>
</SQL>
